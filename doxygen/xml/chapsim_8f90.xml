<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.6" xml:lang="en-US">
  <compounddef id="chapsim_8f90" kind="file" language="Fortran">
    <compoundname>chapsim.f90</compoundname>
      <sectiondef kind="func">
      <memberdef kind="function" id="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>program</type>
        <definition>program chapsim</definition>
        <argsstring></argsstring>
        <name>chapsim</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" line="27" column="1" bodyfile="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" bodystart="27" bodyend="-1"/>
        <references refid="chapsim_8f90_1a84b82317be917b25403f1c6f314c2774" compoundref="chapsim_8f90" startline="276" endline="282">finalise_chapsim</references>
        <references refid="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" compoundref="chapsim_8f90" startline="40" endline="105">initialize_chapsim</references>
        <references refid="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" compoundref="chapsim_8f90" startline="123" endline="271">solve_eqs_iteration</references>
      </memberdef>
      <memberdef kind="function" id="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>subroutine</type>
        <definition>subroutine initialize_chapsim</definition>
        <argsstring></argsstring>
        <name>initialize_chapsim</name>
        <briefdescription>
<para>Initialisation and preprocessing of geometry, mesh and tools This subroutine is called at beginning of the main program. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" line="39" column="1" bodyfile="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" bodystart="40" bodyend="105"/>
        <references refid="namespacepoisson__interface__mod_1a7715725c9593f4b9ce7c5a47999e6984" compoundref="poisson__interface_8f90" startline="94" endline="255">poisson_interface_mod::build_up_poisson_interface</references>
        <references refid="namespacegeometry__mod_1a7f8b6944cb80440500dba9b23eff33d9" compoundref="geometry_8f90" startline="169" endline="254">geometry_mod::buildup_geometry_mesh_info</references>
        <references refid="namespacedomain__decomposition__mod_1ac4044991e260f7b49417c085c5076e3f" compoundref="domain__decomposition_8f90" startline="125" endline="160">domain_decomposition_mod::buildup_mpi_domain_decomposition</references>
        <references refid="namespacethermo__info__mod_1a82626d241159c7cbbb6225b0ee746507" compoundref="input__thermo_8f90" startline="1074" endline="1085">thermo_info_mod::buildup_thermo_mapping_relations</references>
        <references refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" compoundref="tools__general_8f90" startline="144" endline="258">code_performance_mod::call_cpu_time</references>
        <references refid="namespacecode__performance__mod_1a53ba0fb8e472621261d034302234e33b" compoundref="tools__general_8f90" startline="104" endline="109">code_performance_mod::cpu_time_code_start</references>
        <references refid="namespacefiles__io__mod_1a1708286a142eb58c7cb6e29b4051dea9" compoundref="modules_8f90" startline="511" endline="515">files_io_mod::create_directory</references>
        <references refid="namespacedecomp__2d__poisson_1a1502c904f8136f9694eb52b81c352c23" compoundref="poisson__1stderivcomp_8f90" startline="69" endline="253">decomp_2d_poisson::decomp_2d_poisson_init</references>
        <references refid="namespaceflow__thermo__initialiasation_1a395fb421dbaf27d583aa51eb93e569db" compoundref="flow__initialization_8f90" startline="431" endline="516">flow_thermo_initialiasation::initialize_flow_fields</references>
        <references refid="namespacempi__mod_1ace6b537ebaaebbe05ebacff813e69cd9" compoundref="mpi__mod_8f90" startline="34" endline="37">mpi_mod::initialize_mpi</references>
        <references refid="namespaceflow__thermo__initialiasation_1acc32ef453f381fb8e3fb89a7d4161aa1" compoundref="flow__initialization_8f90" startline="521" endline="583">flow_thermo_initialiasation::initialize_thermo_fields</references>
        <references refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" compoundref="mpi__mod_8f90" startline="9" endline="9">mpi_mod::nxdomain</references>
        <references refid="namespaceoperations_1af8e6bc20982e3d9bad88608f6b5866e4" compoundref="operations_8f90" startline="1911" endline="2209">operations::prepare_lhs_coeffs_for_operations</references>
        <references refid="tools__general_8f90_1af581e821bfba315c15c862f8206cb68d" compoundref="tools__general_8f90" startline="46" endline="50">print_debug_end_msg</references>
        <references refid="tools__general_8f90_1a9f30e215c65cc9fd014ca9b95d12054e" compoundref="tools__general_8f90" startline="26" endline="33">print_debug_start_msg</references>
        <references refid="namespaceinput__general__mod_1adfebae4c9a57b6f8b1fced8f1202ec8a" compoundref="input__general_8f90" startline="48" endline="585">input_general_mod::read_input_parameters</references>
        <references refid="test__algrithms_8f90_1af4d0dac680876cfbc04f4621e2deca57" compoundref="test__algrithms_8f90" startline="1267" endline="1297">test_algorithms</references>
        <referencedby refid="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" compoundref="chapsim_8f90" startline="27">chapsim</referencedby>
      </memberdef>
      <memberdef kind="function" id="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>subroutine</type>
        <definition>subroutine solve_eqs_iteration</definition>
        <argsstring></argsstring>
        <name>solve_eqs_iteration</name>
        <briefdescription>
<para>solve the governing equations in iteration </para>
        </briefdescription>
        <detaileddescription>
<para>This subroutine is the main solver. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">none</parametername>
</parameternamelist>
<parameterdescription>
<para>NA </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">none</parametername>
</parameternamelist>
<parameterdescription>
<para>NA </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" line="122" column="1" bodyfile="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" bodystart="123" bodyend="271"/>
        <references refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" compoundref="tools__general_8f90" startline="144" endline="258">code_performance_mod::call_cpu_time</references>
        <references refid="namespacesolver__tools__mod_1a4911d18db7727c74c5b44e73fa5b277d" compoundref="tools__solver_8f90" startline="253" endline="357">solver_tools_mod::check_cfl_convection</references>
        <references refid="namespacesolver__tools__mod_1a71aca419fd2005140cd37d86d4c0bb1b" compoundref="tools__solver_8f90" startline="218" endline="235">solver_tools_mod::check_cfl_diffusion</references>
        <references refid="namespacecontinuity__eq__mod_1ad1c35d1cc4d793816fd59e02b04501fc" compoundref="eq__continuity_8f90" startline="232" endline="277">continuity_eq_mod::check_mass_conservation</references>
        <references refid="namespaceinput__general__mod_1a4b51bc867a3f5e23a4b1a0bd11e9276b" compoundref="input__general_8f90" startline="31" endline="31">input_general_mod::cpu_nfre</references>
        <references refid="namespacecode__performance__mod_1a877ccad21cb5e94cb85441bea06d55ff" compoundref="tools__general_8f90" startline="104">code_performance_mod::cpu_time_iter_end</references>
        <references refid="namespacecode__performance__mod_1a582a4629dee69c4d5b501d19aec3232e" compoundref="tools__general_8f90" startline="104">code_performance_mod::cpu_time_iter_start</references>
        <references refid="namespacecode__performance__mod_1a1a405b7cb7fccf87804d44799662c6d8" compoundref="tools__general_8f90" startline="104">code_performance_mod::cpu_time_step_end</references>
        <references refid="namespacecode__performance__mod_1ad801d10430294b220f8d9a67ddb9f8d8" compoundref="tools__general_8f90" startline="104">code_performance_mod::cpu_time_step_start</references>
        <references refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" compoundref="modules_8f90" startline="497" endline="497">vars_df_mod::domain</references>
        <references refid="namespacesolver__tools__mod_1acd1593557b4b753220579c12a6d9adbe" compoundref="tools__solver_8f90" startline="527" endline="564">solver_tools_mod::find_maximum_absvar3d</references>
        <references refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" compoundref="modules_8f90" startline="498" endline="498">vars_df_mod::flow</references>
        <references refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" compoundref="mpi__mod_8f90" startline="9" endline="9">mpi_mod::nxdomain</references>
        <references refid="tools__general_8f90_1a9f30e215c65cc9fd014ca9b95d12054e" compoundref="tools__general_8f90" startline="26" endline="33">print_debug_start_msg</references>
        <references refid="namespaceeq__energy__mod_1a82f1c1da98b5e5e9ee750872aef3b8ea" compoundref="eq__energy_8f90" startline="244" endline="268">eq_energy_mod::solve_energy_eq</references>
        <references refid="namespaceeq__momentum__mod_1aff2c8eb477eb7c2965a020f4f957ad65" compoundref="eq__momentum_8f90" startline="1138" endline="1228">eq_momentum_mod::solve_momentum_eq</references>
        <references refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" compoundref="modules_8f90" startline="499" endline="499">vars_df_mod::thermo</references>
        <references refid="namespacesolver__tools__mod_1ae96e4f9af2f12ebc4e599872707d7199" compoundref="tools__solver_8f90" startline="49" endline="85">solver_tools_mod::update_prgr</references>
        <references refid="namespacesolver__tools__mod_1a234a4efa9f2a4eacaa8dc7b7f076f92a" compoundref="tools__solver_8f90" startline="30" endline="45">solver_tools_mod::update_re</references>
        <references refid="namespacestatistics__mod_1a4efbbb18e707f3f261e2045d67093465" compoundref="statistics_8f90" startline="88" endline="150">statistics_mod::update_statistics_flow</references>
        <references refid="namespacestatistics__mod_1aa42706a9126c374b25d00c00e53c861b" compoundref="statistics_8f90" startline="176" endline="198">statistics_mod::update_statistics_thermo</references>
        <references refid="namespaceio__restart__mod_1a979fcc7012f872c3dd04950896dd25c0" compoundref="io__restart_8f90" startline="17" endline="49">io_restart_mod::write_instantanous_flow_raw_data</references>
        <references refid="namespaceio__restart__mod_1aa93b01003fe48e8933546c72e7f0605e" compoundref="io__restart_8f90" startline="54" endline="79">io_restart_mod::write_instantanous_thermo_raw_data</references>
        <references refid="namespaceio__monitor__mod_1a942be4b33ff043158a9c0cd251201d2e" compoundref="io__monitor_8f90" startline="222" endline="270">io_monitor_mod::write_monitor_flow</references>
        <references refid="namespaceio__monitor__mod_1ac2c9117acbf4f791a29d5cd5c048c706" compoundref="io__monitor_8f90" startline="275" endline="322">io_monitor_mod::write_monitor_thermo</references>
        <references refid="namespaceio__monitor__mod_1ad5afed0fe672723e03d2eef60a927e9e" compoundref="io__monitor_8f90" startline="144" endline="217">io_monitor_mod::write_monitor_total</references>
        <references refid="namespaceio__visulisation__mod_1aa0a64224c76c7e08d3563c40734e553a" compoundref="io__visulisation_8f90" startline="373" endline="426">io_visulisation_mod::write_snapshot_flow</references>
        <references refid="namespaceio__visulisation__mod_1a48c6833dc0d5bdca8e14aa7edd2a634b" compoundref="io__visulisation_8f90" startline="461" endline="495">io_visulisation_mod::write_snapshot_flow_stat</references>
        <references refid="namespaceio__visulisation__mod_1a1f325d0dd0affb3085d7fc493563a1b9" compoundref="io__visulisation_8f90" startline="431" endline="456">io_visulisation_mod::write_snapshot_thermo</references>
        <references refid="namespaceio__visulisation__mod_1a45afea518059de355c1409d0a1b5a59a" compoundref="io__visulisation_8f90" startline="500" endline="527">io_visulisation_mod::write_snapshot_thermo_stat</references>
        <references refid="namespacestatistics__mod_1ac762b61041b8d5f2777c96b80e05448a" compoundref="statistics_8f90" startline="155" endline="171">statistics_mod::write_statistics_flow</references>
        <references refid="namespacestatistics__mod_1a4c0d15dee40d4079de3ee08d5b7e36a2" compoundref="statistics_8f90" startline="203" endline="212">statistics_mod::write_statistics_thermo</references>
        <references refid="namespacewtformat__mod_1a15c757945b41460da897af12a1277377" compoundref="modules_8f90" startline="289" endline="289">wtformat_mod::wrtfmt1e</references>
        <referencedby refid="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" compoundref="chapsim_8f90" startline="27">chapsim</referencedby>
      </memberdef>
      <memberdef kind="function" id="chapsim_8f90_1a84b82317be917b25403f1c6f314c2774" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>subroutine</type>
        <definition>subroutine finalise_chapsim</definition>
        <argsstring></argsstring>
        <name>finalise_chapsim</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" line="275" column="1" bodyfile="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90" bodystart="276" bodyend="282"/>
        <references refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" compoundref="tools__general_8f90" startline="144" endline="258">code_performance_mod::call_cpu_time</references>
        <references refid="namespacecode__performance__mod_1a3eb99b7dca4fc1b24f143f910b5479f6" compoundref="tools__general_8f90" startline="104">code_performance_mod::cpu_time_code_end</references>
        <references refid="namespacempi__mod_1a080da44d3f16f0256c299c8a0e442051" compoundref="mpi__mod_8f90" startline="42" endline="42">mpi_mod::finalise_mpi</references>
        <referencedby refid="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" compoundref="chapsim_8f90" startline="27">chapsim</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>the main program. </para>
    </briefdescription>
    <detaileddescription>
<sect2 id="chapsim_8f90_1autotoc_md0">
<title>CHAPSim version 2.0.0</title>
<para>This file is part of CHAPSim, a general-purpose CFD tool.</para>
<para>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</para>
<para>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</para>
<para>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA. <simplesect kind="author"><para>Wei Wang <ulink url="mailto:wei.wang@stfc.ac.uk">wei.wang@stfc.ac.uk</ulink> </para>
</simplesect>
<simplesect kind="date"><para></para>
</simplesect>
</para>
</sect2>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="comment">!==========================================================================================================</highlight></codeline>
<codeline lineno="26"><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">program</highlight><highlight class="normal"><sp/><ref refid="chapsim_8f90_1a7b9e8e3c3b9f9b7cfefe9c7805b3a796" kindref="member">chapsim</ref></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" kindref="member">initialize_chapsim</ref></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" kindref="member">solve_eqs_iteration</ref></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1a84b82317be917b25403f1c6f314c2774" kindref="member">finalise_chapsim</ref></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">end<sp/>program</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="comment">!==========================================================================================================</highlight></codeline>
<codeline lineno="38"><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">subroutine<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" kindref="member">initialize_chapsim</ref></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod" kindref="compound">code_performance_mod</ref></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceinput__general__mod" kindref="compound">input_general_mod</ref></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacegeometry__mod" kindref="compound">geometry_mod</ref></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacethermo__info__mod" kindref="compound">thermo_info_mod</ref></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceoperations" kindref="compound">operations</ref></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacedomain__decomposition__mod" kindref="compound">domain_decomposition_mod</ref></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceflow__thermo__initialiasation" kindref="compound">flow_thermo_initialiasation</ref></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacempi__mod" kindref="compound">mpi_mod</ref></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod" kindref="compound">code_performance_mod</ref></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacedecomp__2d__poisson" kindref="compound">decomp_2d_poisson</ref></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacepoisson__interface__mod" kindref="compound">poisson_interface_mod</ref></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacefiles__io__mod" kindref="compound">files_io_mod</ref></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>i</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!<sp/>initialisation<sp/>of<sp/>mpi,<sp/>nrank,<sp/>nproc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacefiles__io__mod_1a1708286a142eb58c7cb6e29b4051dea9" kindref="member">create_directory</ref></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1a53ba0fb8e472621261d034302234e33b" kindref="member">cpu_time_code_start</ref>,<sp/>0,<sp/>0)</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacempi__mod_1ace6b537ebaaebbe05ebacff813e69cd9" kindref="member">initialize_mpi</ref></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!<sp/>reading<sp/>input<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceinput__general__mod_1adfebae4c9a57b6f8b1fced8f1202ec8a" kindref="member">read_input_parameters</ref></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!<sp/>build<sp/>up<sp/>geometry<sp/>information</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1,<sp/><ref refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" kindref="member">nxdomain</ref></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacegeometry__mod_1a7f8b6944cb80440500dba9b23eff33d9" kindref="member">buildup_geometry_mesh_info</ref>(domain(i))<sp/></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!<sp/>build<sp/>up<sp/>thermo_mapping_relations,<sp/>independent<sp/>of<sp/>any<sp/>domains</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(any(domain(:)%is_thermo))<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>1<sp/></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacethermo__info__mod_1a82626d241159c7cbbb6225b0ee746507" kindref="member">buildup_thermo_mapping_relations</ref>(thermo(i),<sp/>domain(i))</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="comment">!<sp/>build<sp/>up<sp/>operation<sp/>coefficients<sp/>for<sp/>all<sp/>x-subdomains</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceoperations_1af8e6bc20982e3d9bad88608f6b5866e4" kindref="member">prepare_lhs_coeffs_for_operations</ref></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">!<sp/>build<sp/>up<sp/>domain<sp/>decomposition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacedomain__decomposition__mod_1ac4044991e260f7b49417c085c5076e3f" kindref="member">buildup_mpi_domain_decomposition</ref></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="comment">!<sp/>build<sp/>up<sp/>fft<sp/>basic<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1,<sp/><ref refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" kindref="member">nxdomain</ref></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacepoisson__interface__mod_1a7715725c9593f4b9ce7c5a47999e6984" kindref="member">build_up_poisson_interface</ref>(domain(i))</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(nrank<sp/>==<sp/>0<sp/>)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="tools__general_8f90_1a9f30e215c65cc9fd014ca9b95d12054e" kindref="member">print_debug_start_msg</ref>(</highlight><highlight class="stringliteral">&quot;Initializing<sp/>Poisson<sp/>solver<sp/>...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacedecomp__2d__poisson_1a1502c904f8136f9694eb52b81c352c23" kindref="member">decomp_2d_poisson_init</ref>()</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(nrank<sp/>==<sp/>0<sp/>)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="tools__general_8f90_1af581e821bfba315c15c862f8206cb68d" kindref="member">print_debug_end_msg</ref></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="comment">!<sp/>Initialize<sp/>flow<sp/>and<sp/>thermo<sp/>fields</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1,<sp/><ref refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" kindref="member">nxdomain</ref></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceflow__thermo__initialiasation_1a395fb421dbaf27d583aa51eb93e569db" kindref="member">initialize_flow_fields</ref>(flow(i),<sp/>domain(i))</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(domain(i)%is_thermo)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceflow__thermo__initialiasation_1acc32ef453f381fb8e3fb89a7d4161aa1" kindref="member">initialize_thermo_fields</ref>(thermo(i),<sp/>flow(i),<sp/>domain(i))</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="test__algrithms_8f90_1af4d0dac680876cfbc04f4621e2deca57" kindref="member">test_algorithms</ref>()</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="keyword">end<sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1a4d3be256458fe2bd1e077dd34aa9dbca" kindref="member">initialize_chapsim</ref></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="comment">!==========================================================================================================</highlight></codeline>
<codeline lineno="114"><highlight class="comment">!----------------------------------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="comment">!<sp/>Arguments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight><highlight class="comment">!______________________________________________________________________________.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight><highlight class="comment">!<sp/><sp/>mode<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>role<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight><highlight class="comment">!______________________________________________________________________________!</highlight></codeline>
<codeline lineno="121"><highlight class="comment">!_______________________________________________________________________________</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122" refid="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">subroutine<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" kindref="member">solve_eqs_iteration</ref></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!use<sp/>iso_fortran_env</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod" kindref="compound">solver_tools_mod</ref></highlight><highlight class="comment">!,<sp/><sp/><sp/>only<sp/>:<sp/>Check_cfl_diffusion,<sp/>Check_cfl_convection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecontinuity__eq__mod" kindref="compound">continuity_eq_mod</ref></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!use<sp/>poisson_mod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceeq__energy__mod" kindref="compound">eq_energy_mod</ref></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceeq__momentum__mod" kindref="compound">eq_momentum_mod</ref></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceflow__thermo__initialiasation" kindref="compound">flow_thermo_initialiasation</ref><sp/></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod" kindref="compound">code_performance_mod</ref></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacethermo__info__mod" kindref="compound">thermo_info_mod</ref></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacevars__df__mod" kindref="compound">vars_df_mod</ref></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceinput__general__mod" kindref="compound">input_general_mod</ref></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacempi__mod" kindref="compound">mpi_mod</ref></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacewtformat__mod" kindref="compound">wtformat_mod</ref></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceio__visulisation__mod" kindref="compound">io_visulisation_mod</ref></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceio__monitor__mod" kindref="compound">io_monitor_mod</ref></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceio__tools__mod" kindref="compound">io_tools_mod</ref></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespaceio__restart__mod" kindref="compound">io_restart_mod</ref></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacestatistics__mod" kindref="compound">statistics_mod</ref></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">logical</highlight><highlight class="normal"><sp/>::<sp/>is_flow<sp/><sp/><sp/>=<sp/>.false.</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">logical</highlight><highlight class="normal"><sp/>::<sp/>is_thermo<sp/>=<sp/>.false.</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>i</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>iter,<sp/>isub</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>iteration</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>niter</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!<sp/>flow<sp/>advancing/marching<sp/>iteration/time<sp/>control</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/>iteration<sp/>=<sp/>huge(0)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/>niter<sp/><sp/><sp/><sp/><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1,<sp/><ref refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" kindref="member">nxdomain</ref></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%iteration<sp/><sp/><sp/><sp/>&lt;<sp/>iteration)<sp/>iteration<sp/>=<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%iteration</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%nIterFlowEnd<sp/>&gt;<sp/>niter)<sp/><sp/><sp/><sp/><sp/>niter<sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%nIterFlowEnd</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%iteration<sp/><sp/><sp/><sp/><sp/><sp/>&lt;<sp/>iteration)<sp/>iteration<sp/>=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%iteration</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%nIterThermoEnd<sp/>&gt;<sp/>niter)<sp/><sp/><sp/><sp/><sp/>niter<sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%nIterThermoEnd</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1ad801d10430294b220f8d9a67ddb9f8d8" kindref="member">cpu_time_step_start</ref>,<sp/>iteration,<sp/>niter)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(nrank<sp/>==<sp/>0)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="tools__general_8f90_1a9f30e215c65cc9fd014ca9b95d12054e" kindref="member">print_debug_start_msg</ref>(</highlight><highlight class="stringliteral">&quot;Solving<sp/>the<sp/>governing<sp/>equations<sp/>...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>iter<sp/>=<sp/>iteration<sp/>+<sp/>1,<sp/>niter</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>mod(iter,<sp/><ref refid="namespaceinput__general__mod_1a4b51bc867a3f5e23a4b1a0bd11e9276b" kindref="member">cpu_nfre</ref>)<sp/>==<sp/>0)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1a582a4629dee69c4d5b501d19aec3232e" kindref="member">cpu_time_iter_start</ref>,<sp/>iteration,<sp/>niter,<sp/>iter)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Solver<sp/>for<sp/>each<sp/>domain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1,<sp/><ref refid="namespacempi__mod_1a6123cf0e7ce2dc58dc67899c55f63a04" kindref="member">nxdomain</ref></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/><sp/><sp/><sp/><sp/>setting<sp/>up<sp/>1/re,<sp/>1/re/prt,<sp/>gravity,<sp/>etc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1a234a4efa9f2a4eacaa8dc7b7f076f92a" kindref="member">update_re</ref>(iter,<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i))</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/>&amp;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1ae96e4f9af2f12ebc4e599872707d7199" kindref="member">update_prgr</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i))</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/><sp/><sp/><sp/><sp/>setting<sp/>up<sp/>flow<sp/>solver</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(iter<sp/>&gt;=<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%nIterFlowStart)<sp/>.and.<sp/>(iter<sp/>&lt;=<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%nIterFlowEnd))<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_flow<sp/>=<sp/>.true.</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%time<sp/>=<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%time<sp/>+<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%dt</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%iteration<sp/>=<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%iteration<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1a71aca419fd2005140cd37d86d4c0bb1b" kindref="member">check_cfl_diffusion</ref><sp/>(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%h2r(:),<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%rre,<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%dt)</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1a4911d18db7727c74c5b44e73fa5b277d" kindref="member">check_cfl_convection</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qx,<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qy,<sp/><ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qz,<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/><sp/><sp/><sp/>setting<sp/>up<sp/>thermo<sp/>solver</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(iter<sp/>&gt;=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%nIterThermoStart)<sp/>.and.<sp/>(iter<sp/>&lt;=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%nIterThermoEnd))<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_thermo<sp/>=<sp/>.true.</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%time<sp/>=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%time<sp/><sp/>+<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%dt</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%iteration<sp/>=<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i)%iteration<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/><sp/><sp/><sp/>main<sp/>solver</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>isub<sp/>=<sp/>1,<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%nsubitr</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(is_thermo)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceeq__energy__mod_1a82f1c1da98b5e5e9ee750872aef3b8ea" kindref="member">solve_energy_eq</ref><sp/><sp/>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i),<sp/>isub)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(is_flow)<sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceeq__momentum__mod_1aff2c8eb477eb7c2965a020f4f957ad65" kindref="member">solve_momentum_eq</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i),<sp/>isub)</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/>validation<sp/>for<sp/>each<sp/>time<sp/>step</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1acd1593557b4b753220579c12a6d9adbe" kindref="member">find_maximum_absvar3d</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qx,<sp/></highlight><highlight class="stringliteral">&quot;maximum<sp/>ux:&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacewtformat__mod_1a15c757945b41460da897af12a1277377" kindref="member">wrtfmt1e</ref>)</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1acd1593557b4b753220579c12a6d9adbe" kindref="member">find_maximum_absvar3d</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qy,<sp/></highlight><highlight class="stringliteral">&quot;maximum<sp/>uy:&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacewtformat__mod_1a15c757945b41460da897af12a1277377" kindref="member">wrtfmt1e</ref>)</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesolver__tools__mod_1acd1593557b4b753220579c12a6d9adbe" kindref="member">find_maximum_absvar3d</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i)%qz,<sp/></highlight><highlight class="stringliteral">&quot;maximum<sp/>uz:&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacewtformat__mod_1a15c757945b41460da897af12a1277377" kindref="member">wrtfmt1e</ref>)</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecontinuity__eq__mod_1ad1c35d1cc4d793816fd59e02b04501fc" kindref="member">check_mass_conservation</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))<sp/></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/>update<sp/>statistics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iter<sp/>&gt;<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%stat_istart)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacestatistics__mod_1a4efbbb18e707f3f261e2045d67093465" kindref="member">update_statistics_flow</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iter<sp/>&gt;<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%stat_istart)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacestatistics__mod_1aa42706a9126c374b25d00c00e53c861b" kindref="member">update_statistics_thermo</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/>monitoring<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!if(domain(i)%icase<sp/>==<sp/>ICASE_TGV2D)<sp/>call<sp/>Validate_TGV2D_error<sp/>(flow(i),<sp/>domain(i))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__monitor__mod_1ad5afed0fe672723e03d2eef60a927e9e" kindref="member">write_monitor_total</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__monitor__mod_1a942be4b33ff043158a9c0cd251201d2e" kindref="member">write_monitor_flow</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__monitor__mod_1ac2c9117acbf4f791a29d5cd5c048c706" kindref="member">write_monitor_thermo</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/>write<sp/>out<sp/>check<sp/>point<sp/>data<sp/>for<sp/>restart</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mod(iter,<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%ckpt_nfre)<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__restart__mod_1a979fcc7012f872c3dd04950896dd25c0" kindref="member">write_instantanous_flow_raw_data</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iter<sp/>&gt;<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%stat_istart)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacestatistics__mod_1ac762b61041b8d5f2777c96b80e05448a" kindref="member">write_statistics_flow</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__restart__mod_1aa93b01003fe48e8933546c72e7f0605e" kindref="member">write_instantanous_thermo_raw_data</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iter<sp/>&gt;<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%stat_istart)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacestatistics__mod_1a4c0d15dee40d4079de3ee08d5b7e36a2" kindref="member">write_statistics_thermo</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>write<sp/>data<sp/>for<sp/>visualisation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!==========================================================================================================</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(mod(iter,<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%visu_nfre)<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__visulisation__mod_1aa0a64224c76c7e08d3563c40734e553a" kindref="member">write_snapshot_flow</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__visulisation__mod_1a1f325d0dd0affb3085d7fc493563a1b9" kindref="member">write_snapshot_thermo</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iter<sp/>&gt;<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%stat_istart<sp/>)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__visulisation__mod_1a48c6833dc0d5bdca8e14aa7edd2a634b" kindref="member">write_snapshot_flow_stat</ref>(<ref refid="namespacevars__df__mod_1a45db29afdff9d575da87ef1fe1d33337" kindref="member">flow</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i)%is_thermo)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespaceio__visulisation__mod_1a45afea518059de355c1409d0a1b5a59a" kindref="member">write_snapshot_thermo_stat</ref>(<ref refid="namespacevars__df__mod_1acd558a7d1175a73b084faa6be8e3e2be" kindref="member">thermo</ref>(i),<sp/><ref refid="namespacevars__df__mod_1a3965c08cac4d41b94b4a1cc15fba1734" kindref="member">domain</ref>(i))</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/>end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/>end<sp/>do</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">!<sp/>domain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>mod(iter,<sp/><ref refid="namespaceinput__general__mod_1a4b51bc867a3f5e23a4b1a0bd11e9276b" kindref="member">cpu_nfre</ref>)<sp/>==<sp/>0)<sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1a877ccad21cb5e94cb85441bea06d55ff" kindref="member">cpu_time_iter_end</ref>,<sp/>iteration,<sp/>niter,<sp/>iter)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/>end<sp/>do</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">!<sp/>iteration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1a1a405b7cb7fccf87804d44799662c6d8" kindref="member">cpu_time_step_end</ref>,<sp/>iteration,<sp/>niter)</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight><highlight class="keyword">end<sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1ab30f00d1c9ff9c81f83b5218c966acd9" kindref="member">solve_eqs_iteration</ref></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275" refid="chapsim_8f90_1a84b82317be917b25403f1c6f314c2774" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">subroutine<sp/></highlight><highlight class="normal"><ref refid="chapsim_8f90_1a84b82317be917b25403f1c6f314c2774" kindref="member">finalise_chapsim</ref></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacempi__mod" kindref="compound">mpi_mod</ref></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod" kindref="compound">code_performance_mod</ref></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacecode__performance__mod_1ae72ca126357a5b4395337168da0e392a" kindref="member">call_cpu_time</ref>(<ref refid="namespacecode__performance__mod_1a3eb99b7dca4fc1b24f143f910b5479f6" kindref="member">cpu_time_code_end</ref>,<sp/>0,<sp/>0)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacempi__mod_1a080da44d3f16f0256c299c8a0e442051" kindref="member">finalise_mpi</ref>()</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight><highlight class="keyword">end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/Users/wei.wang/Work/11_CHAPSim/CHAPSim/CHAPSim2/src/chapsim.f90"/>
  </compounddef>
</doxygen>
